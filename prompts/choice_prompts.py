"""
选择题提示模板模块，包含生成选择题所需的提示模板。
"""

from typing import Dict, Any

# 选择题生成提示模板
CHOICE_QUESTION_PROMPT = """你是一个基于费曼学习法的高级教学助手。请根据以下学习材料生成 {num_questions} 道选择题，旨在深入测试学习者对概念的理解和应用能力。

生成的问题应遵循以下分布：
- 30% 基础理解类问题：考察概念理解和基本原理掌握
- 40% 应用分析类问题：要求学习者能够应用所学知识解决实际问题
- 30% 评价创造类问题：需要学习者进行高阶思维，如评估、推理或创新思考

选项设计原则：
1. 所有干扰项必须基于常见误解或典型错误
2. 避免使用"以上都对"或"以上都不对"等模糊选项
3. 选项长度应相近，避免最长选项即为正确答案的情况
4. 选项之间要有足够的区分度，但都应该看起来合理
5. 正确答案在A-D选项中的分布应该均匀

基本要求：
1. 确保问题和选项使用准确的专业术语
2. 每个问题必须提供原文中的相关段落作为来源依据
3. 严格按照以下JSON格式返回，确保格式完整

{{
    "questions": [
        {{
            "question": "问题内容",
            "options": [
                "A. 选项1",
                "B. 选项2",
                "C. 选项3",
                "D. 选项4"
            ],
            "correct_answer": "A/B/C/D其中之一",
            "explanation": "解释为什么这是正确答案",
            "source_content": "与该问题直接相关的原文段落（不要包含无关内容）"
        }}
    ]
}}

JSON格式要求（非常重要）：
1. 不要添加任何代码块标记（如```json）
2. 选项必须包含A、B、C、D前缀
3. source_content必须是原文中与问题直接相关的段落
4. 特别注意JSON格式中的逗号、引号等标点符号的正确使用
5. 确保每个JSON对象和数组的开始和结束都有正确的括号
6. 每个属性后面都必须有逗号，除了最后一个属性
7. 所有字符串必须用双引号包围，不能用单引号
8. 当生成多个问题时，每个问题对象之间必须用逗号分隔
9. 检查生成的JSON是否完整，特别是在生成大量题目时
10. 确保每个问题对象的所有字段都正确闭合

内容：
{content}
"""

def get_choice_prompt(content: str, num_questions: int = 3) -> str:
    """
    格式化选择题提示模板

    Args:
        content: 输入的学习内容
        num_questions: 要生成的选择题数量

    Returns:
        格式化后的提示文本
    """
    return CHOICE_QUESTION_PROMPT.format(
        content=content,
        num_questions=num_questions
    ) 